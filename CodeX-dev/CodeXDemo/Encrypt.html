<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="Site.css" rel="Stylesheet" type="text/css" />
    <style type="text/css">
        .auto-style1 {
            text-align: center;
            color: red;
            background-color: #FFFFFF;
        }
        .auto-style2 {
            color: red;
        }
    </style>
</head>
<body>
    <table>
        <tr>
            <td style="border-right: dotted">
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;
<span style="color: blue;">            var</span>&nbsp;algo&nbsp;=&nbsp;<span style="color: #2b91af;">Rijndael</span>.Create();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">var</span>&nbsp;deriveBytes&nbsp;=&nbsp;<span
    style="color: blue;">new</span>&nbsp;<span style="color: #2b91af;">Rfc2898DeriveBytes</span>(sharedSecret,&nbsp;<span
        style="color: #2b91af;">Encoding</span>.UTF8.GetBytes(salt));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;algo.Key&nbsp;=&nbsp;deriveBytes.GetBytes(algo.KeySize&nbsp;/&nbsp;8);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #2b91af;">ICryptoTransform</span>&nbsp;encryptor&nbsp;=&nbsp;algo.CreateEncryptor(algo.Key,&nbsp;algo.IV);
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">using</span>&nbsp;(<span
    style="color: blue;">var</span>&nbsp;msEncrypt&nbsp;=&nbsp;<span style="color: blue;">new</span>&nbsp;<span
        style="color: #2b91af;">MemoryStream</span>())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msEncrypt.Write(<span
    style="color: #2b91af;">BitConverter</span>.GetBytes(algo.IV.Length),&nbsp;0,&nbsp;<span
        style="color: blue;">sizeof</span>(<span style="color: blue;">int</span>));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msEncrypt.Write(algo.IV,&nbsp;0,&nbsp;algo.IV.Length);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
    style="color: blue;">using</span>&nbsp;(<span style="color: blue;">var</span>&nbsp;csEncrypt&nbsp;=&nbsp;<span
        style="color: blue;">new</span>&nbsp;<span style="color: #2b91af;">CryptoStream</span>(msEncrypt,&nbsp;encryptor,&nbsp;<span
            style="color: #2b91af;">CryptoStreamMode</span>.Write))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
    style="color: blue;">using</span>&nbsp;(<span style="color: blue;">var</span>&nbsp;swEncrypt&nbsp;=&nbsp;<span
        style="color: blue;">new</span>&nbsp;<span style="color: #2b91af;">StreamWriter</span>(csEncrypt))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swEncrypt.Write(s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
    style="color: blue;">return</span>&nbsp;<span style="color: #2b91af;">Convert</span>.ToBase64String(msEncrypt.ToArray());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
                <pre style="background-position: 0% 0%; font-family: Consolas; font-size: 13; background-image: none; background-repeat: repeat; background-attachment: scroll;" class="auto-style1">
Total Number of lines needed : 10</pre>
            </td>
            <td>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">testString.Encrypt(<span style="color: #a31515;">&quot;password&quot;</span>)
</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;">&nbsp;</pre>
                <pre style="font-family: Consolas; font-size: 13; color: black; background: white;"><span class="auto-style2">Total Number of lines needed : 1</span></pre>
            </td>
        </tr>
    </table>
</body>
</html>
